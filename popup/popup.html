<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>aiFiverr Assistant</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="popup-container">
    <!-- Header -->
    <header class="popup-header">
      <div class="logo">
        <img src="../icons/icon48.png" alt="aiFiverr" class="logo-icon">
        <h1>aiFiverr</h1>
      </div>
      <div class="status-indicator" id="statusIndicator">
        <span class="status-dot"></span>
        <span class="status-text">Ready</span>
      </div>
    </header>

    <!-- Navigation Tabs -->
    <nav class="tab-navigation">
      <button class="tab-btn active" data-tab="dashboard">Dashboard</button>
      <button class="tab-btn" data-tab="sessions">Sessions</button>
      <button class="tab-btn" data-tab="settings">Settings</button>
      <button class="tab-btn" data-tab="export">Export</button>
    </nav>

    <!-- Tab Content -->
    <main class="tab-content">
      <!-- Dashboard Tab -->
      <div class="tab-panel active" id="dashboard">
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon">üí¨</div>
            <div class="stat-info">
              <div class="stat-number" id="totalSessions">0</div>
              <div class="stat-label">Active Sessions</div>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">üîë</div>
            <div class="stat-info">
              <div class="stat-number" id="healthyKeys">0</div>
              <div class="stat-label">Healthy API Keys</div>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">üìä</div>
            <div class="stat-info">
              <div class="stat-number" id="totalRequests">0</div>
              <div class="stat-label">Total Requests</div>
            </div>
          </div>
        </div>

        <div class="quick-actions">
          <h3>Quick Actions</h3>
          <div class="action-buttons">
            <button class="action-btn" id="extractConversation">
              <span class="btn-icon">üì•</span>
              Extract Conversation
            </button>
            <button class="action-btn" id="generateReply">
              <span class="btn-icon">‚ú®</span>
              Generate Reply
            </button>
            <button class="action-btn" id="analyzeMessage">
              <span class="btn-icon">üîç</span>
              Analyze Message
            </button>
            <button class="action-btn" id="openFloatingWidget">
              <span class="btn-icon">ü§ñ</span>
              Open AI Assistant
            </button>
          </div>
        </div>

        <div class="recent-activity">
          <h3>Recent Activity</h3>
          <div class="activity-list" id="activityList">
            <div class="activity-item">
              <div class="activity-icon">üí¨</div>
              <div class="activity-content">
                <div class="activity-title">Welcome to aiFiverr!</div>
                <div class="activity-time">Just now</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Sessions Tab -->
      <div class="tab-panel" id="sessions">
        <div class="sessions-header">
          <h3>Chat Sessions</h3>
          <button class="btn-secondary" id="newSession">New Session</button>
        </div>
        
        <div class="sessions-list" id="sessionsList">
          <div class="empty-state">
            <div class="empty-icon">üí¨</div>
            <div class="empty-title">No sessions yet</div>
            <div class="empty-description">Start a conversation on Fiverr to create your first session</div>
          </div>
        </div>
      </div>

      <!-- Settings Tab -->
      <div class="tab-panel" id="settings">
        <div class="settings-section">
          <h3>API Keys</h3>
          <div class="api-keys-container">
            <textarea 
              id="apiKeysInput" 
              placeholder="Enter your Gemini API keys (one per line)&#10;AIzaSyC...&#10;AIzaSyD..."
              rows="4"
            ></textarea>
            <div class="api-keys-actions">
              <button class="btn-primary" id="saveApiKeys">Save API Keys</button>
              <button class="btn-secondary" id="testApiKeys">Test Keys</button>
            </div>
            <div class="api-keys-status" id="apiKeysStatus"></div>
          </div>
        </div>

        <div class="settings-section">
          <h3>Knowledge Base</h3>
          <div class="knowledge-base-container">
            <div class="knowledge-item">
              <input type="text" placeholder="Variable name (e.g., bio)" class="kb-key">
              <textarea placeholder="Variable value" class="kb-value" rows="2"></textarea>
              <button class="btn-icon" onclick="addKnowledgeItem(this)">+</button>
            </div>
            <div id="knowledgeBaseList"></div>
            <button class="btn-secondary" id="addKnowledgeItem">Add Variable</button>
          </div>
        </div>

        <div class="settings-section">
          <h3>Preferences</h3>
          <div class="preferences-container">
            <div class="preference-item">
              <label for="autoSave">Auto-save sessions</label>
              <input type="checkbox" id="autoSave" checked>
            </div>
            <div class="preference-item">
              <label for="notifications">Show notifications</label>
              <input type="checkbox" id="notifications" checked>
            </div>
            <div class="preference-item">
              <label for="keyRotation">Enable API key rotation</label>
              <input type="checkbox" id="keyRotation" checked>
            </div>
            <div class="preference-item">
              <label for="maxContextLength">Max context length</label>
              <input type="number" id="maxContextLength" value="10000" min="1000" max="50000">
            </div>
          </div>
        </div>
      </div>

      <!-- Export Tab -->
      <div class="tab-panel" id="export">
        <div class="export-section">
          <h3>Export Data</h3>
          <div class="export-options">
            <div class="export-format">
              <label>Export Format:</label>
              <select id="exportFormat">
                <option value="json">JSON</option>
                <option value="csv">CSV</option>
                <option value="markdown">Markdown</option>
              </select>
            </div>
            <div class="export-actions">
              <button class="btn-primary" id="exportAllData">Export All Data</button>
              <button class="btn-secondary" id="exportSessions">Export Sessions Only</button>
            </div>
          </div>
        </div>

        <div class="import-section">
          <h3>Import Data</h3>
          <div class="import-container">
            <div class="file-drop-zone" id="fileDropZone">
              <div class="drop-zone-content">
                <div class="drop-icon">üìÅ</div>
                <div class="drop-text">Drop your export file here or click to browse</div>
              </div>
              <input type="file" id="importFile" accept=".json" hidden>
            </div>
            <div class="import-options">
              <div class="import-option">
                <input type="checkbox" id="importApiKeys">
                <label for="importApiKeys">Import API keys (use with caution)</label>
              </div>
              <div class="import-option">
                <input type="checkbox" id="forceImport">
                <label for="forceImport">Force import (ignore version compatibility)</label>
              </div>
            </div>
            <button class="btn-primary" id="importData" disabled>Import Data</button>
          </div>
        </div>

        <div class="backup-section">
          <h3>Backup & Sync</h3>
          <div class="backup-info">
            <p>Regular backups help you maintain your data across browsers and devices.</p>
            <div class="backup-actions">
              <button class="btn-secondary" id="createBackup">Create Backup</button>
              <button class="btn-secondary" id="scheduleBackup">Schedule Auto-Backup</button>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer class="popup-footer">
      <div class="footer-links">
        <a href="#" id="helpLink">Help</a>
        <a href="#" id="feedbackLink">Feedback</a>
        <a href="#" id="aboutLink">About</a>
      </div>
      <div class="version-info">v1.0.0</div>
    </footer>
  </div>

  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loadingOverlay" style="display: none;">
    <div class="loading-spinner">
      <div class="spinner"></div>
      <div class="loading-text">Processing...</div>
    </div>
  </div>

  <!-- Toast Notifications -->
  <div class="toast-container" id="toastContainer"></div>

  <script src="popup.js"></script>
</body>
</html>
